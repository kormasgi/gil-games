<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Web Color Paint</title>
<style>
  body { text-align: center; font-family: Arial; background: #eee; }
  canvas { border: 2px solid black; }
  #controls { margin-bottom: 10px; display:none; }
  .color-btn { width: 40px; height: 40px; border: 2px solid black; cursor: pointer; display: inline-block; }
  #clearBtn { padding: 5px 10px; cursor: pointer; }
</style>
</head>
<body>
<a href="gil-games.html" class="logo-link">
    <img src="android-chrome-512x512.png" alt="Gil Games Logo" class="logo">
    <link rel="stylesheet" href="style.css">
</a>
<h1>Press Enter to Start Paint</h1>
<div id="controls">
  <div class="color-btn" style="background: blue;" data-color="blue"></div>
  <div class="color-btn" style="background: green;" data-color="green"></div>
  <div class="color-btn" style="background: red;" data-color="red"></div>
  <div class="color-btn" style="background: yellow;" data-color="yellow"></div>
  <button id="clearBtn">CLEAR</button>
</div>
<video id="video" width="640" height="480" autoplay style="display:none;"></video>
<canvas id="paintCanvas" width="640" height="480"></canvas>

<script>
let started = false;
let currentColor = 'blue';
let paintPoints = [];
let video, canvas, ctx;

document.addEventListener('keydown', (e) => {
  if(!started && e.key === 'Enter') {
    started = true;
    document.getElementById('controls').style.display = 'block';
    document.querySelector('h1').style.display = 'none';
    video.style.display = 'block';
    startWebcam();
  }
});

// Color selection
document.querySelectorAll('.color-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    currentColor = btn.getAttribute('data-color');
  });
});

// Clear canvas
document.getElementById('clearBtn').addEventListener('click', () => {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  paintPoints = [];
});

// Setup canvas and video
canvas = document.getElementById('paintCanvas');
ctx = canvas.getContext('2d');
video = document.getElementById('video');

function startWebcam() {
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      video.srcObject = stream;
      requestAnimationFrame(processFrame);
    })
    .catch(err => alert("Webcam access denied"));
}

function processFrame() {
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  const frame = ctx.getImageData(0,0,canvas.width,canvas.height);
  const data = frame.data;

  let cx = 0, cy = 0, count = 0;

  // Detect color (blue, green, red, yellow)
  for(let i = 0; i < data.length; i += 4) {
    const r = data[i], g = data[i+1], b = data[i+2];
    let match = false;
    if(currentColor === 'blue' && b > 150 && r < 100 && g < 100) match = true;
    if(currentColor === 'green' && g > 150 && r < 100 && b < 100) match = true;
    if(currentColor === 'red' && r > 150 && g < 100 && b < 100) match = true;
    if(currentColor === 'yellow' && r > 150 && g > 150 && b < 100) match = true;

    if(match) {
      const index = i / 4;
      const x = index % canvas.width;
      const y = Math.floor(index / canvas.width);
      cx += x;
      cy += y;
      count++;
    }
  }

  if(count > 0) {
    const x = cx / count;
    const y = cy / count;
    paintPoints.push({x, y, color: currentColor});
  }

  // Draw all paint points
  for(let i = 1; i < paintPoints.length; i++) {
    const p1 = paintPoints[i-1];
    const p2 = paintPoints[i];
    if(p1.color === p2.color) {
      ctx.strokeStyle = p1.color;
      ctx.lineWidth = 5;
      ctx.beginPath();
      ctx.moveTo(p1.x, p1.y);
      ctx.lineTo(p2.x, p2.y);
      ctx.stroke();
    }
  }

  requestAnimationFrame(processFrame);
}
</script>
</body>
</html>